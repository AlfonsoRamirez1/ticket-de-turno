{% extends "base_admin.html" %}

{% block title %}Gestionar Municipios{% endblock %}

{% block content %}
  <div class="admin-nav" style="align-items: center;">
    <h1>Gestionar Municipios</h1>
    <a href="{{ url_for('admin_catalogos_menu') }}">Volver a Catálogos</a>
  </div>

  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <h2>Crear Nuevo Municipio</h2>
  <form class="crear-form" method="POST" action="{{ url_for('admin_municipios_crear') }}">
    <div class="form-field">
      <label for="nombre">Nombre del Municipio:</label>
      <input type="text" id="nombre" name="nombre" class="text-box" required>
    </div>
    <div class="form-actions">
      <button type="submit">Crear</button>
    </div>
  </form>

  <h2>Municipios Existentes</h2>
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre del Municipio</th>
        <th style="width: 180px;">Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for m in municipios %}
        <tr>
          <td data-label="ID">{{ m.id_municipio }}</td>
          <td data-label="Nombre del Municipio">{{ m.municipio }}</td>
          <td class="action-buttons" data-label="Acciones">
            <a href="{{ url_for('admin_municipios_editar_get', id_municipio=m.id_municipio) }}" class="btn-editar-cat">
              Editar
            </a>

            <form method="POST" action="{{ url_for('admin_municipios_eliminar') }}">
              <input type="hidden" name="id_municipio" value="{{ m.id_municipio }}">
              <button type="submit" class="btn-eliminar"
                      onclick="return confirm('¿Está seguro? Si el municipio está en uso, no se podrá eliminar.')">
                Eliminar
              </button>
            </form>
          </td>
        </tr>
      {% else %}
        <tr>
          <td colspan="3" style="text-align: center;">No hay municipios registrados.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}